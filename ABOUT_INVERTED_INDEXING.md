## 역색인화 (Inverted Indexing)
### 관련 솔루션: 
* http://lucene.apache.org/solr/ (Apache Solr)
* https://www.elastic.co/kr/products/elasticsearch (Amazon ElasticSearch)

### 1. 색인
#### (1) 색인화란?
기본적으로 '색인화(Indexing)'란 대량 문서에서 원하는 내용을 빠르게 검색할 수 있도록 문서를 효율적인 구조로 변환하는 작업을 일컫는다. Solr에서의 색인화는 도큐먼트로부터 색인 테이블을 생성하여 쿼리를 이용한 검색이 가능하도록 만드는 과정을 뜻한다.
#### (2,1) 역색인화란?
보통의 색인 테이블은 **도큐먼트 번호 - 해당 번호에 대응하는 도큐먼트의 내용**으로 구성되는 반면, 역색인 테이블은 **토큰 - 해당 토큰을 포함하는 도큐먼트의 번호**로 이루어져 있다. 역색인화(Inverted Indexing)'는 바로 이 역색인 테이블을 만드는 작업을 뜻한다. 토큰(Token)은 각 도큐먼트의 내용을 의미있는 단어로 분리한(+ 불용어 제거, 정규화 등) 최소 길이의 식별자를 의미하며 여기에는 숫자도 포함된다. 토큰의 분리에는 형태소 분석기(Morpheme Analyzer)가 필요하다.
#### (2.2) 역색인화의 장점
 SQL의 단순 LIKE문이 각 도큐먼트의 실제 내용과 검색어를 비교해야 하는 것에 비해, 역색인 테이블은 도큐먼트의 내용을 탐색할 필요가 없어 토큰화 작업만 빠르게 이루어진다면 검색 시간을 효과적으로 단축할 수 있다.
#### (3) 도큐먼트, 필드란?
도큐먼트와 필드는 관계형 데이터베이스의 테이블을 떠올리면 된다. 도큐먼트는 여러 필드가 모인 그룹으로 정의된다. 필드는 키-값 쌍으로 구성되어 있으며, 하나의 키는 하나의 값(실제 데이터)을 가진다. 따라서 이러한 필드들의 집합인 도큐먼트는 사실상 단일 레코드 기반의 테이블과 유사하다고 볼 수 있다. 단, 일반적인 관계형 데이터베이스 테이블과는 달리 도큐먼트는 중복된 명칭의 필드를 허용한다.

예를 들어, 어떤 웹사이트의 정보를 각 필드에 따라 분류해서 저장할 경우 도큐먼트의 구조는 다음과 같이 만들 수 있다.
```
      ↓ 필드          ↓ 필드             ↓ 필드             ↓ 필드
    +--------+---------------------+-------------+----------------------+
    |   ID   |         URL         |    TITLE    |       CONTENTS       |
    +--------+---------------------+-------------+----------------------+
    |  ...   |         ...         |     ...     |          ...         |
    +--------+---------------------+-------------+----------------------+
                                <도큐먼트 #1>
```
각각의 필드는 반드시 타입을 가져야 하고, 여기서 ID 필드는 IntPointField, URL 필드는 StrField, TITLE과 CONTENTS 필드는 TextField로 타입을 설정할 수 있다.

```
                    +------------+-----------------------------+
                    |    Term    |  Frequency |   Document ID  |
                    +------------+-----------------------------+
                    |     cpp    |      3     |        1       |
                    +------------+-----------------------------+
                    |  developer |      1     |        2       |
                    +------------+-----------------------------+
                    |    code    |      4     |    1, 3, 4     |
                    +------------+-----------------------------+
                    |    java    |      2     | 3, 4, 7, 8, 10 |
                    +------------+-----------------------------+
                    |     git    |      6     |      4, 9      |
                    +------------+-----------------------------+
                    |     ...    |     ...    |      ...       |
                    +------------+-----------------------------+
                                    <역색인 테이블>
```
사용자가 'cpp code'를 검색했다면, cpp와 code가 모두 나타나는 1번 도큐먼트가 반환된다.

### 2. 검색
역색인 테이블에서의 검색은 사용자가 입력한 검색어와 일치하거나 연관성이 높은 도큐먼트를 찾는 과정이다. 이를 수행하려면 문자열 형식의 검색어를 일정한 규격을 가진 최소 형태인 토큰으로 파싱(tokenizing, query parsing)하는 과정이 필요하다. 검색어가 적절한 클래스를 거쳐 토큰으로 분리되면, 해당 토큰을 역색인 테이블의 Term 필드 값과 비교하여 일치 또는 유사하다고 판단되는 도큐먼트를 반환한다.
